# Answer-Only Iterated Summarization experiment for Countdown puzzles using DeepSeek-RL reasoning with Qwen2.5 summarization via vLLM
experiment_name: "countdown_deepseek_rl_answer_only_vllm"
results_dir: "./results/countdown_deepseek_rl_answer_only_vllm"
data_path: "./data/countdown_custom_2.csv"
save_intermediate: true
experiment_type: "summarize"

# Dashboard configuration
dashboard_port: 8080

# Model configuration for vLLM
# DeepSeek-RL for reasoning (running on port 8001)
reasoning_model: "deepseek-ai/DeepSeek-R1-Distill-Qwen-14B"
reasoning_model_provider: "vllm"

# Qwen2.5 for summarization (running on port 8000)
summarizer_type: "external"
summarizer_model: "Qwen/Qwen2.5-14B-Instruct"
summarizer_model_provider: "vllm"

# vLLM server configuration for reasoning model (DeepSeek on GPU 1)
vllm_config:
  host: "localhost"
  port: 8001
  max_model_len: 32768

# vLLM server configuration for summarizer model (Qwen on GPU 0)
summarizer_vllm_config:
  host: "localhost"
  port: 8000
  max_model_len: 32768

# Generation parameters for reasoning
max_tokens: 25000  # Extended reasoning trace
temperature: 0.6
top_p: 0.95
top_k: 40
presence_penalty: 0.0
frequency_penalty: 0.0

# Continuation parameters for long reasoning traces
enable_continuation: false  # Disable to avoid context accumulation bug
max_total_tokens: 25000
max_continuations: 1  # Set to 1 to avoid "maximum continuation limit (0)" error

# Iteration parameters
max_iterations: 4
continue_after_correct: true

# Summarization parameters - Answer-Only Mode
enable_summarization: true
enable_final_summarization: true
summarization_mode: "answer_only"  # NEW: Use answer-only summarization instead of full summaries
allow_fallback: true
extract_post_think_summary: false  # Not used in answer-only mode
summary_max_tokens: 0  # Not used for answer-only mode since no LLM calls are made
summary_temperature: 0.6
summary_top_p: 0.95
summary_top_k: 40
summary_presence_penalty: 0.0
summary_frequency_penalty: 0.0

# Summary continuation parameters (not used for answer-only mode)
summary_max_total_tokens: 5000
summary_max_continuations: 1

# Answer extraction - use Countdown-specific extractor
answer_extractor: "countdown"

# Prompt configurations
prompts:
  reasoning: "countdown"  # References config/prompts/reasoning.yaml
  summarize: "countdown_summary"  # References config/prompts/summarize.yaml (not used in answer-only mode)
  improved: "countdown_your_approach"  # Use same reasoning prompt for improved iterations