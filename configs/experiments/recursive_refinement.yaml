# Configuration for recursive reasoning refinement experiment

# Base configuration (will be merged with this config)
base_config: configs/experiments/baseline.yaml

# Pipeline configuration
pipeline:
  name: recursive_refinement
  type: recursive
  batch_size: 4
  save_intermediates: true
  max_iterations: 3
  early_stopping: true
  confidence_threshold: 0.8
  
  # Prompts for different steps
  continuation_prompt: "Based on the summary of your previous reasoning, please continue solving the problem. Focus specifically on addressing the issues identified in the summary."
  evaluation_prompt: "Evaluate the above reasoning and answer. Is it correct? If there are errors, what are they? Should the reasoning be refined further?"
  synthesis_prompt: "Based on all the iterations of reasoning so far, synthesize a final answer to the problem."

# Model configuration (import from files)
imports:
  - configs/models/fireworks.yaml
  - configs/summarization/default.yaml

# Summarization configuration
summarization:
  method: external
  strategy: error_focused
  prompt: error_focused
  max_tokens: 1000
  temperature: 0.5
  
  # External summarization specific settings
  external_summary:
    strategy: error_focused
    prompt: error_focused
    max_tokens: 1000
    temperature: 0.5

# Reasoning model 
reasoning_model:
  name: deepseek-r1
  model_id: accounts/fireworks/models/deepseek-r1

# Summarization model (same as reasoning by default)
summarization_model:
  name: deepseek-r1
  model_id: accounts/fireworks/models/deepseek-r1

# Recursive pipeline specific settings
recursive:
  use_think_tags: true
  use_summarize_tags: false  # Experimental feature for <summarize> tags
  track_confidence: true
  refine_errors_only: true  # Only refine iterations where errors were detected

# Reasoning configuration overrides
reasoning:
  think_tag: true
  max_extensions: 5
  target_token_count: 2000

# Evaluation configuration
evaluation:
  metrics:
    - accuracy
    - improvement_rate
    - wrong_to_right_percentage
  tolerance: 0.01  # Numerical tolerance for answer comparison

# Output configuration
output:
  results_path: results/recursive_refinement
  save_format: json
  visualizations: true

# Logging configuration
logging:
  level: INFO
  save_path: logs
  console_output: true
  log_file: true